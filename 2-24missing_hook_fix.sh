#!/bin/bash

echo "üîß –ò–°–ü–†–ê–í–õ–Ø–ï–ú –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô useDualAgent –•OOK"

cd frontend/src/hooks

# ============================================================================
# 1. –°–û–ó–î–ê–¢–¨ –ù–ï–î–û–°–¢–ê–Æ–©–ò–ô useDualAgent.js
# ============================================================================

cat > useDualAgent.js << 'EOF'
import { useState } from 'react'

export const useDualAgent = () => {
  const [agent, setAgent] = useState('claudy') // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Claudy –∞–∫—Ç–∏–≤–µ–Ω

  return {
    agent,
    setAgent
  }
}
EOF

echo "‚úÖ useDualAgent.js —Å–æ–∑–¥–∞–Ω"

# ============================================================================
# 2. –ü–†–û–í–ï–†–ò–¢–¨ –ß–¢–û –§–ê–ô–õ –°–û–ó–î–ê–õ–°–Ø
# ============================================================================

if [ -f "useDualAgent.js" ]; then
    echo "‚úÖ –§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $(ls -la useDualAgent.js)"
else
    echo "‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞"
    exit 1
fi

# ============================================================================
# 3. –ü–†–û–í–ï–†–ò–¢–¨ –ò–ú–ü–û–†–¢ –í App.jsx
# ============================================================================

cd ../
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–º–ø–æ—Ä—Ç –≤ App.jsx..."

if grep -q "useDualAgent" App.jsx; then
    echo "‚úÖ –ò–º–ø–æ—Ä—Ç useDualAgent –Ω–∞–π–¥–µ–Ω –≤ App.jsx"
else
    echo "‚ö†Ô∏è –ò–º–ø–æ—Ä—Ç useDualAgent –ù–ï –Ω–∞–π–¥–µ–Ω –≤ App.jsx"
fi

# ============================================================================
# 4. –¢–ï–°–¢ –°–ë–û–†–ö–ò
# ============================================================================

cd ../..
echo "üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–±–æ—Ä–∫—É..."

npm run build

if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ –°–ë–û–†–ö–ê –£–°–ü–ï–®–ù–ê!"
    echo ""
    echo "üéØ –ö–û–ú–ú–ò–¢–ò–ú –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:"
    echo "   git add ."
    echo "   git commit -m 'Add missing useDualAgent hook - fix runtime errors'"
    echo "   git push origin main"
    echo ""
    echo "üöÄ –ü–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞:"
    echo "   - Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç –ø—Ä–æ–µ–∫—Ç"
    echo "   - –ß–µ—Ä–Ω—ã–π —ç–∫—Ä–∞–Ω –∏—Å—á–µ–∑–Ω–µ—Ç"
    echo "   - File Tree –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ"
else
    echo "‚ùå –°–±–æ—Ä–∫–∞ –ø–∞–¥–∞–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏"
fi